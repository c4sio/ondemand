<div class="page-header">
    <h1>
        Assinantes
        <small> 
            <i class="ace-icon fa fa-angle-double-right"></i> 
            <span ng-show="action === 'editar'">Editar</span>
        </small>
    </h1>
</div>
<!-- /.page-header -->

<!-- PAGE CONTENT BEGINS -->
<div class="row">
    <div class="col-xs-12">
        <!-- Form Holder -->
        <div class="form-holder">
            <!-- Back button -->
            <span class="back-button" title="voltar">
                <a href="javascript: history.back();"><i class="fa fa-arrow-circle-left"></i></a>            
            </span>
            <!-- End:: Back button -->

            <fieldset>
                <!-- begin:: tabs -->
                <div class="tabbable">
                    <ul class="nav nav-tabs"
                        role="tablist"
                        ng-init="tab = 1">
                        <li ng-class="{active: tab === 1}">
                            <a href ng-click="setTab(tab, 1)" role="tab" data-toggle="tab">
                                Equipamentos
                            </a>
                        </li>
                        <li ng-class="{active: tab === 2}">
                            <a href ng-click="setTab(tab, 2)" role="tab" data-toggle="tab">
                                Pacotes
                            </a>
                        </li>
                    </ul>

                    <div class="tab-content">
                        <div class="tab-pane"
                            ng-class="{active: activeTab === 1}">

                            <form class="form-horizontal"
                                  name="formEquipments"
                                  novalidate
                                  ng-submit="submitFormEquipments()">

                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="form-group no-margin" ng-class="{ 'has-error' : formEquipments.serial.$invalid && !formEquipments.serial.$pristine }">
                                                <label class="control-label no-padding-right" for="serial">Serial</label>
                                                <input
                                                    name="serial"
                                                    id="serial"
                                                    ng-model="formEquipmentData.serial"
                                                    type="text"
                                                    class="form-control"
                                                    ng-required="true"
                                                    maxlength="20">
                                                <p ng-show="formEquipments.serial.$invalid && !formEquipments.serial.$pristine"
                                                class="help-inline no-padding">Campo obrigatório</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-3">
                                        <div class="form-group no-margin" ng-class="{ 'has-error' : formEquipments.cardId.$invalid && !formEquipments.cardId.$pristine }">
                                            <label class="control-label no-padding-right" for="cardId">Card ID</label>
                                            <input
                                                name="cardId"
                                                id="cardId"
                                                ng-model="formEquipmentData.cardId"
                                                type="text"
                                                class="form-control"
                                                ng-required="true"
                                                maxlength="20">
                                            <p ng-show="formEquipments.cardId.$invalid && !formEquipments.cardId.$pristine"
                                            class="help-inline no-padding">Campo obrigatório</p>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="form-group no-margin" ng-class="{ 'has-error' : formEquipments.mainKey.$invalid && !formEquipments.mainKey.$pristine }">
                                            <label class="control-label no-padding-right" for="mainKey">Main Key</label>
                                            <input
                                                name="mainKey"
                                                id="mainKey"
                                                ng-model="formEquipmentData.mainKey"
                                                type="text"
                                                class="form-control"
                                                ng-required="true"
                                                maxlength="20">
                                            <p ng-show="formEquipments.mainKey.$invalid && !formEquipments.mainKey.$pristine"
                                            class="help-inline no-padding">Campo obrigatório</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-3">
                                        <div class="form-group no-margin" ng-class="{ 'has-error' : formEquipments.cas.$invalid && !formEquipments.cas.$pristine }">
                                            <label class="control-label no-padding-right" for="cas">CAS</label>
                                            <input
                                                name="cas"
                                                id="cas"
                                                ng-model="formEquipmentData.cas"
                                                type="text"
                                                class="form-control"
                                                ng-required="true"
                                                maxlength="20">
                                            <p ng-show="formEquipments.cas.$invalid && !formEquipments.cas.$pristine"
                                            class="help-inline no-padding">Campo obrigatório</p>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="form-group no-margin" ng-class="{ 'has-error' : formEquipments.equipmentType.$invalid && !formEquipments.equipmentType.$pristine }">
                                            <label class="control-label no-padding-right" for="equipmentType">Equipment Type</label>
                                            <select
                                                id="equipmentType"
                                                ng-required="true"
                                                name="equipmentType"
                                                ng-model="formEquipmentData.typeDesc"
                                                ng-options="equipmentType.description for equipmentType in equipmentTypes"
                                                class="form-control"></select>

                                                <p ng-show="formEquipments.equipmentType.$invalid && !formEquipments.equipmentType.$pristine"
                                                class="help-inline no-padding">Campo obrigatório</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="clearfix form-actions">
                                            <button class="btn btn-info" ng-disabled="!formEquipments.$valid">
                                                <i class="ace-icon fa fa-check bigger-110"></i>
                                                Cadastrar
                                            </button>
                                        </div>
                                    </div>
                                </div>

                                <div class="space-12"></div>

                                <div class="row">
                                    <div class="col-md-12">

                                        <h3 class="header smaller lighter blue">Lista de Equipamentos</h3>

                                        <div ng-if="!data.equipments" class="alert alert-info">
                                            <i class="fa fa-circle-o-notch fa-spin"></i> Carregando...
                                        </div>

                                        <div ng-if="data.equipments && !data.equipments.length" class="alert alert-info">
                                            <i class="fa fa-info-circle"></i>
                                            O assinante ainda não possui equipamentos cadastrados.
                                        </div>

                                        <table ng-if="data.equipments.length"
                                               class="table table-striped table-bordered table-hover dataTable table-toolbar-right">
                                            <thead>
                                                <tr>
                                                    <th>
                                                        <a href="javascript: void(0);" ng-click="sortEquipments('serial')">Serial</a>
                                                        <!-- Caret -->
                                                        <span ng-show="orderByFieldEquipments === 'serial'">
                                                            <span ng-show="!reverseSortEquipments"><i class="fa fa-caret-up"></i></span>
                                                            <span ng-show="reverseSortEquipments"><i class="fa fa-caret-down"></i></span>
                                                        </span>
                                                        <!-- End:: Caret -->
                                                    </th>
                                                    <th>
                                                        <a href="javascript: void(0);" ng-click="sortEquipments('cardId')">Card Id</a>
                                                        <!-- Caret -->
                                                        <span ng-show="orderByFieldEquipments === 'cardId'">
                                                            <span ng-show="!reverseSortEquipments"><i class="fa fa-caret-up"></i></span>
                                                            <span ng-show="reverseSortEquipments"><i class="fa fa-caret-down"></i></span>
                                                        </span>
                                                        <!-- End:: Caret -->
                                                    </th>
                                                    <th>
                                                        <a href="javascript: void(0)"  ng-click="sortEquipments('mainKey')">Main Key</a>
                                                        <!-- Caret -->
                                                        <span ng-show="orderByFieldEquipments === 'mainKey'">
                                                            <span ng-show="!reverseSortEquipments"><i class="fa fa-caret-up"></i></span>
                                                            <span ng-show="reverseSortEquipments"><i class="fa fa-caret-down"></i></span>
                                                        </span>
                                                        <!-- End:: Caret -->
                                                    </th>
                                                    <th>
                                                        <a href="javascript: void(0);" ng-click="sortEquipments('cas')"> CAS </a>
                                                        <!-- Caret -->
                                                        <span ng-show="orderByFieldEquipments === 'cas'">
                                                            <span ng-show="!reverseSortEquipments"><i class="fa fa-caret-up"></i></span>
                                                            <span ng-show="reverseSortEquipments"><i class="fa fa-caret-down"></i></span>
                                                        </span>
                                                        <!-- End:: Caret -->
                                                    </th>
                                                    <th>
                                                        <a href="javascript: void(0);" ng-click="sortEquipments('typeDesc')"> Type Desc </a>
                                                        <!-- Caret -->
                                                        <span ng-show="orderByFieldEquipments === 'typeDesc'">
                                                            <span ng-show="!reverseSortEquipments"><i class="fa fa-caret-up"></i></span>
                                                            <span ng-show="reverseSortEquipments"><i class="fa fa-caret-down"></i></span>
                                                        </span>
                                                        <!-- End:: Caret -->
                                                    </th>
                                                    <th></th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr ng-repeat="equipment in data.equipments | orderBy:orderByFieldEquipments:reverseSortEquipments">
                                                    <td>{{ equipment.serial }}</td>
                                                    <td>{{ equipment.cardId }}</td>
                                                    <td>{{ equipment.mainKey }}</td>
                                                    <td>{{ equipment.cas }}</td>
                                                    <td>{{ equipment.typeDesc.description || '--' }}</td>
                                                    <td>
                                                        <div class="hidden-sm hidden-xs btn-group">
                                                            <a href="javascript: void(0);"
                                                                ng-click="removeEquipment($event, equipment.serial)"
                                                                tooltip="Remover"
                                                                class="btn btn-xs btn-danger">
                                                                <i class="ace-icon fa fa-trash-o bigger-120"></i>
                                                            </a>
                                                        </div>

                                                        <!-- Responsive Toolbar -->
                                                        <div class="hidden-md hidden-lg">
                                                            <div class="inline position-relative">
                                                                <button class="btn btn-minier btn-primary dropdown-toggle" data-toggle="dropdown" data-position="auto">
                                                                    <i class="ace-icon fa fa-cog icon-only bigger-110"></i>
                                                                </button>
                                                                <ul class="dropdown-menu dropdown-only-icon dropdown-yellow dropdown-menu-right dropdown-caret dropdown-close">
                                                                    <li>
                                                                        <a href="javascript: void(0);"
                                                                           ng-click="removeEquipment($event, equipment.serial)"
                                                                           class="tooltip-success"
                                                                           tooltip="Remover"
                                                                           >
                                                                            <span class="green">
                                                                                <i class="ace-icon fa fa-trash-o bigger-120"></i>
                                                                            </span>
                                                                        </a>
                                                                    </li>
                                                                </ul>
                                                            </div>
                                                        </div>
                                                        <!-- End:: Responsive Toolbar -->

                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </form>

                        </div>
                        <div class="tab-pane"
                            ng-class="{active: activeTab === 2}">
                            <form class="form-horizontal">
                                <div class="form-group no-margin">
                                    <h4 class="header smaller lighter blue">Utilize o campo abaixo para inserir e remover pacotes</h4>
                                    <ui-select
                                        multiple
                                        ng-disabled="disabled"
                                        ng-model="selectComponent.selectedPackages"
                                        on-select="onSelect($item, $model)"
                                        on-remove="onRemove($item, $model)">
                                        <ui-select-match placeholder="Selecione um pacote">{{ $item.otherId }}</ui-select-match>
                                        <ui-select-choices repeat="package in packages | filter: $select.search">
                                            {{ package.otherId }}
                                        </ui-select-choices>
                                    </ui-select>
                                </div>
                            </form>
                        </div>
                    </div>

                </div>
                <!-- end:: tabs -->
            </fieldset>

        </div>
    </div>
</div>

